name: flying_enemy
move_speed: 2.2
follow_range: 420
attack_range: 0
attack_frames: 55
transform:
  x: 0
  y: 0
  scale_x: 1
  scale_y: 1
  rotation: 0
sprite:
  use_source: false
  origin_x: 0
  origin_y: 0
collider:
  width: 36
  height: 32
  offsetX: 14
  offsetY: 16
render_layer:
  index: 90
health: 2
animation:
  sheet: flying_drone.png
  current: idle
  defs:
    idle:
      name: idle
      row: 0
      col_start: 0
      frame_count: 4
      frame_w: 48
      frame_h: 48
      fps: 8
      loop: true
    run:
      name: run
      row: 2
      col_start: 0
      frame_count: 4
      frame_w: 48
      frame_h: 48
      fps: 10
      loop: true
    attack:
      name: attack
      row: 1
      col_start: 0
      frame_count: 8
      frame_w: 48
      frame_h: 48
      fps: 10
      loop: false
    hit:
      name: hit
      row: 3
      col_start: 2
      frame_count: 1
      frame_w: 48
      frame_h: 48
      fps: 10
      loop: false
    death:
      name: death
      row: 4
      col_start: 0
      frame_count: 6
      frame_w: 48
      frame_h: 48
      fps: 10
      loop: false
audio:
  - name: attack
    file: enemy_attack.wav
    volume: 1.0
  - name: hit
    file: enemy_hit.wav
    volume: 1.0
  - name: death
    file: enemy_death.wav
    volume: 1.0
fsm:
  initial: idle
  states:
    idle:
      on_enter:
        - set_animation: idle
      while:
        - stop_xy: true
    follow:
      on_enter:
        - set_animation: run
      while:
        - move_towards_player_2d: true
        - face_player: true
    attack:
      on_enter:
        - set_animation: attack
        - start_timer: 1.2
        - play_audio: attack
      while:
        - stop_xy: true
        - tick_timer: true
      on_exit:
        - stop_audio: attack
    hit:
      on_enter:
        - set_animation: hit
        - start_timer: 0.15
        - add_white_flash: 20
        - add_invulnerable: true
        - play_audio: hit
      while:
        - stop_xy: true
        - tick_timer: true
      on_exit:
        - remove_invulnerable: true
    death:
      on_enter:
        - set_animation: death
        - start_timer: 2.0
        - add_invulnerable: true
        - play_audio: death
      while:
        - stop_xy: true
        - tick_timer: true
      on_exit:
        - destroy_self: true
    destroy:
  transitions:
    idle:
      - sees_player: follow
      - hit: hit
    follow:
      - loses_player: idle
      - in_attack_range: attack
      - hit: hit
    attack:
      - timer_expired: follow
      - loses_player: idle
      - hit: hit
    hit:
      - out_of_health: death
      - timer_expired: idle
    death:
      - timer_expired: destroy

hitboxes:
  - width: 42
    height: 24
    offset_x: 30
    offset_y: 20
    damage: 1
    anim: attack
    frames: [5]

hurtboxes:
  - width: 36
    height: 32
    offset_x: 14
    offset_y: 16
